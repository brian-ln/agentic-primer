{"id":"ap-10a","title":"Specify cross-shard message forwarding protocol","lifecycle":"completed","priority":"P0","description":"Define how messages route between Signal Hub instances when actors on different shards. Kimi marked as BLOCKING. Must specify: actor location discovery, forwarding message format, failure handling, TTL across hops, circular forwarding prevention. Deliverable: Add to PROTOCOL.md and SCALABILITY.md","assignee":"@(system)"}
{"id":"ap-4ei","title":"Fix API signature mismatches (.onMessage → .on('message'))","lifecycle":"completed","priority":"P2","description":"Replace 3 instances of .onMessage() with .on('message') in messaging.test.ts:286, pubsub.test.ts:80, pubsub.test.ts:98. Quick win - estimated 30 minutes.","assignee":"@(system)"}
{"id":"ap-0qe","title":"Add hub:refresh_token to MVP","lifecycle":"completed","priority":"P1","description":"Design token refresh mechanism to avoid forced disconnect/reconnect every 1-4 hours. Kimi upgraded to HIGH. Must specify: hub:refresh_token message type, token refresh flow, grace period handling, security considerations (replay attacks, token rotation). Add to MESSAGE_TYPES.md and PROTOCOL.md","assignee":"@(system)"}
{"id":"ap-5fi","title":"Define JSON Schema + Zod for hub:* messages","lifecycle":"completed","priority":"P0","description":"Create language-agnostic JSON Schema definitions for all 24 hub:* message types. Generate Zod validators from JSON Schema (following agentic-primer pattern). Kimi upgraded to P0 (MUST FIX before MVP). Files: schema/hub-messages.schema.json, generated zod validators.","assignee":"@(system)"}
{"id":"ap-2nc","title":"P0: Connection Lifecycle Fixes (WS1.1)","lifecycle":"completed","priority":"P0","description":"Implement duplicate connection detection and fix disconnect response ordering. Includes connection state tracking for observability. Success: Reconnection tests pass, old sessions properly cleaned up.","assignee":"@(system)"}
{"id":"ap-3m1","title":"Fix actor discovery returning empty results (5 tests)","lifecycle":"completed","priority":"P2","description":"Actor discovery returns empty or incomplete arrays. Investigate registry storage in Durable Object, verify hub:discover handler, fix storage or query logic. Can run parallel to message delivery investigation. Estimated 2-3 hours.","assignee":"@(system)"}
{"id":"ap-gn2","title":"Signal Hub Implementation","lifecycle":"completed","priority":"P1","description":"Build Signal Hub on Cloudflare Workers using session-gateway pattern to enable protocol convergence across SEAG (local) ↔ Signal Hub (Workers) ↔ Browser clients. Validates the entire stack end-to-end with real-world actor coordination.","assignee":"@(system)"}
{"id":"ap-azc","title":"Flatten hub:send payload structure","lifecycle":"completed","priority":"P2","description":"Redesign hub:send to eliminate confusing nested addressing (outer 'to' vs inner 'to'). Current: message-within-message pattern. Goal: Single-level addressing. No breaking changes to SharedMessage spec. Update PROTOCOL.md and MESSAGE_TYPES.md. Opus P1, Kimi downgraded to V2 (defer).","assignee":"@(system)"}
{"id":"ap-gn2.1","title":"Design Signal Hub protocol and schema","lifecycle":"completed","priority":"P1","description":"Define the message protocol for Signal Hub actor coordination. Specify message types (register, broadcast, point-to-point), schema using @agentic-primer/protocols types, and wire format. Document in docs/signal-hub/PROTOCOL.md with examples.","assignee":"@(system)"}
{"id":"ap-gn2.2","title":"Implement Signal Hub on Cloudflare Workers","lifecycle":"completed","priority":"P1","description":"Build Signal Hub using session-gateway pattern from docs/actor-design/patterns/. Use Durable Objects for actor state, WebSocket for connections. Implement protocol from design task. Location: services/signal-hub/","assignee":"@(system)"}
{"id":"ap-gn2.4","title":"Create Signal Hub browser client","lifecycle":"completed","priority":"P1","description":"Build lightweight browser client for Signal Hub using native WebSocket. No framework dependencies. Expose API for connecting browser-based actors. Include in packages/signal-hub-client/","assignee":"@(system)"}
{"id":"ap-5r3","title":"Replace jsonwebtoken with jose library","lifecycle":"completed","priority":"P1","description":"Update SECURITY.md to use panva/jose instead of jsonwebtoken for Cloudflare Workers compatibility (Web Crypto API vs Node.js crypto). Update all JWT examples, verification flows, import statements. Verify jose works in Workers runtime.","assignee":"@(system)"}
{"id":"ap-gn2.5","title":"End-to-end Signal Hub integration tests","lifecycle":"completed","priority":"P2","description":"Test SEAG → Signal Hub → Browser flow. Validate message delivery, actor discovery, failover scenarios. Add to tests/integration/signal-hub/","assignee":"@(system)"}
{"id":"ap-gn2.3","title":"Integrate SEAG with Signal Hub client","lifecycle":"completed","priority":"P1","description":"Add Signal Hub client to SEAG/UGS that connects local actors to remote Signal Hub. Implement reconnection logic, message routing, and state sync. Update ugs/ codebase.","assignee":"@(system)"}
{"id":"ap-lr1","title":"Investigate and fix message delivery timeouts (22 tests)","lifecycle":"completed","priority":"P2","description":"Critical blocker: All messaging, pub/sub, and broadcast tests timing out at 5000ms. Add debug logging to client and hub, trace message flow, identify breakpoint, implement fix. Estimated 4-6 hours. Affects 73% of failures.","assignee":"@(system)"}
{"id":"ap-zyx","title":"Fix session cleanup on disconnect (1 test)","lifecycle":"completed","priority":"P3","description":"Session ID not cleared after disconnect. Add 'this.sessionId = null' to SignalHubClient disconnect() method. Simple fix, estimated 15 minutes. Can be done anytime in parallel.","assignee":"@(system)"}
{"id":"ap-rls","title":"Test: Framework Fixes (WS3.1)","lifecycle":"completed","priority":"P0","description":"Fix module import error, investigate and resolve broadcast/pub/sub timeout root causes, fix message ordering race condition. Success: All 13 failing tests pass, test suite stable."}
{"id":"ap-5a4","title":"P0: Performance & Observability (WS1.3)","lifecycle":"completed","priority":"P0","description":"Remove verbose debug logging from hot paths, add DEBUG flag support, implement basic per-minute metrics. Success: Log volume reduced >90%, metrics collection operational."}
{"id":"ap-907","title":"P2: Developer Experience (WS4.2)","lifecycle":"completed","priority":"P2","description":"Enhance error messages with resolution steps, add client sendMessage() convenience API. Success: All errors actionable, flat payload construction hidden from users."}
{"id":"ap-a8v","title":"P1: Reliability & Operations (WS2.2)","lifecycle":"completed","priority":"P1","description":"Reduce heartbeat interval to 20s, implement structured JSON logging across all handlers. Success: Heartbeat 20s interval, all logs JSON-formatted and queryable."}
{"id":"ap-ayo","title":"P1: Security & Correctness (WS2.1)","lifecycle":"completed","priority":"P1","description":"Implement per-session rate limiting, fix unsubscribe to be topic-specific, resolve target address ambiguity. Success: Rate limiting active (10 msg/sec), unsubscribe works per-topic, target addressing unambiguous."}
{"id":"ap-br1","title":"P2: Performance Optimizations (WS4.1)","lifecycle":"completed","priority":"P2","description":"Add inverse index for subscription cleanup (O(S) not O(T)), optimize broadcast JSON.stringify (stringify once). Success: Disconnect <10ms with 100 topics, broadcast CPU reduced >50%."}
{"id":"ap-uo6","title":"P2: Advanced Features (WS4.3)","lifecycle":"completed","priority":"P2","description":"Implement hub:refresh_token for long-lived sessions. Success: Sessions >1 hour can refresh tokens, documented in PROTOCOL.md."}
{"id":"ap-j1s","title":"End-to-end integration verification (100% pass rate)","lifecycle":"completed","priority":"P2","description":"Final verification after all fixes complete. Run full test suite 3x to verify 43/43 tests pass consistently. Check performance metrics, document results. Estimated 30 minutes. Depends on all previous phases."}
{"id":"ap-x6y","title":"P0: Resource Protection (WS1.2)","lifecycle":"completed","priority":"P0","description":"Schedule TTL cleanup alarm, add message size check before parse, enforce broadcast limit. Prevents resource exhaustion attacks. Success: Alarms fire, oversized messages rejected, broadcast limit enforced."}
{"id":"ap-ym7","title":"Test: Coverage Expansion (WS3.2)","lifecycle":"completed","priority":"P1","description":"Add handler unit tests (registration, messaging, pubsub), create reconnection scenario tests. Success: Handler coverage >80%, reconnection scenarios validated."}
{"id":"md-lint","title":"Add markdown linting to check workflow","lifecycle":"pending","priority":"P3","description":"Install markdownlint-cli2 at root. Run --fix first to auto-fix blanks/headings/fences. Disable remaining noisy rules (MD034, MD040) or fix manually. Scope lint:md to packages/ and services/ to avoid historical noise in core/ and archive/. Then add to root check target."}
{"id":"bun-backpressure","title":"BunWebSocketBridge: handle send() backpressure via drain queue","lifecycle":"completed","priority":"P3","description":"BunWebSocketBridge.broadcast() ignores the number return value of ws.send(). When send() returns -1 (backpressure) or 0 (dropped), messages are silently lost. Implement a per-connection queue that buffers unsent messages and flushes in the handleDrain() handler. See packages/bun/TRANSPORTS.md for context.","assignee":"claude"}
{"id":"ap-bin-proto","title":"Binary channel protocol types: ChannelOpen/Opened/Close/Error","lifecycle":"completed","priority":"P1","assignee":"claude"}
{"id":"ap-bin-fnv32a","title":"fnv32a hash utility in bridge-utils.ts","lifecycle":"completed","priority":"P1","assignee":"claude"}
{"id":"ap-bin-serde","title":"PassthroughSerde: identity serde for binary payloads","lifecycle":"completed","priority":"P1","assignee":"claude"}
{"id":"ap-bin-mw","title":"binaryChannelMiddleware: channel.open/close control plane","lifecycle":"completed","priority":"P1","assignee":"claude"}
{"id":"ap-bin-frame","title":"handleBinaryFrame() utility: channelId lookup -> actor tell","lifecycle":"completed","priority":"P1","assignee":"claude"}
{"id":"ap-bin-client","title":"Client-side binary channel: channelOpen(), encodeBinaryFrame(), fnv32a for browser/Bun callers","lifecycle":"completed","priority":"P1","assignee":"claude"}
{"id":"ap-bin-cf","title":"CF WebSocketBridge: ArrayBuffer dispatch via channel map","lifecycle":"completed","priority":"P1","assignee":"claude"}
{"id":"ap-bin-bun","title":"Bun WebSocketBridge: Uint8Array dispatch via channel map","lifecycle":"completed","priority":"P1","assignee":"claude"}
{"id":"ap-bin-tests","title":"Binary channel protocol: integration tests","lifecycle":"completed","priority":"P1","assignee":"claude"}
{"id":"ap-virt-factory","title":"Virtual actor factory hook in MessageRouter (on address miss)","lifecycle":"completed","priority":"P1","assignee":"claude"}
{"id":"ap-virt-hier","title":"Hierarchical routing: virtual actor creation at segment boundaries","lifecycle":"completed","priority":"P1","assignee":"claude"}
{"id":"ap-virt-tests","title":"Virtual actor routing: tests","lifecycle":"completed","priority":"P1","assignee":"claude"}
{"id":"ai-scaffold","title":"@agentic-primer/ai package scaffold: tsconfig, package.json, index","lifecycle":"completed","priority":"P2","assignee":"claude"}
{"id":"ai-schema","title":"Provider config schema: Zod types for gateway/provider/model/credentials","lifecycle":"completed","priority":"P2","assignee":"claude"}
{"id":"ai-protocol-types","title":"Canonical AI actor message type definitions: inference/tts/stt/audio/session","lifecycle":"completed","priority":"P2","assignee":"claude"}
{"id":"ai-creds","title":"CredentialsActor: @(ai/credentials/*) — CF AIG tokens, API keys","lifecycle":"completed","priority":"P2","assignee":"claude"}
{"id":"ai-gateway","title":"GatewayActor: @(ai/gateway/*) — CF AI Gateway instance, health, discovery","lifecycle":"completed","priority":"P2","assignee":"claude"}
{"id":"ai-inference","title":"InferenceActor: @(ai/inference/gateway/provider/model) — virtual LLM","lifecycle":"completed","priority":"P2","assignee":"claude"}
{"id":"ai-tts","title":"TtsActor: @(ai/tts/gateway/provider/model) — virtual TTS","lifecycle":"completed","priority":"P2","assignee":"claude"}
{"id":"ai-stt","title":"SttActor: @(ai/stt/gateway/provider/model) — virtual STT + binary channel","lifecycle":"completed","priority":"P2","assignee":"claude"}
{"id":"ai-embeddings","title":"EmbeddingsActor: @(ai/embeddings/*) — virtual embeddings with batching","lifecycle":"completed","priority":"P2","assignee":"claude"}
{"id":"ai-session","title":"SessionActor: @(ai/session/user-id) — durable session, conversation history","lifecycle":"completed","priority":"P2","assignee":"claude"}
{"id":"ai-discovery","title":"Discovery protocol: ai.discover and ai.health across all actors","lifecycle":"completed","priority":"P2","assignee":"claude"}
{"id":"ai-tests","title":"@agentic-primer/ai: integration tests across all actor types","lifecycle":"completed","priority":"P2","assignee":"claude"}
{"id":"bl-flux-relay","title":"FluxRelayActor: replaces VoiceSession DO, uses SttActor + binary channel","lifecycle":"completed","priority":"P2","assignee":"claude"}
{"id":"bl-session","title":"agent-hub: wire SessionActor, replace SignalHubAgent impl","lifecycle":"completed","priority":"P3","assignee":"claude"}
{"id":"bl-wrangler","title":"brianln.ai: wrangler.toml/jsonc updates for actor-based services","lifecycle":"completed","priority":"P3","assignee":"claude"}
{"id":"dm-inference","title":"daemon: InferenceActor adapter wrapping chat/messages handlers","lifecycle":"completed","priority":"P3","assignee":"claude"}
{"id":"dm-tts","title":"daemon: TtsActor adapter wrapping TTS handler","lifecycle":"completed","priority":"P3","assignee":"claude"}
{"id":"dm-stt","title":"daemon: SttActor adapter wrapping STT handler","lifecycle":"completed","priority":"P3","assignee":"claude"}
{"id":"dm-embeddings","title":"daemon: EmbeddingsActor adapter wrapping embeddings handler","lifecycle":"completed","priority":"P3","assignee":"claude"}
{"id":"dm-scaffold","title":"daemon: BunActorSystem scaffold alongside existing HTTP endpoints","lifecycle":"completed","priority":"P3","description":"DONE in daemon: BunActorSystem scaffold in ~/.claude/skills/ai/app/daemon/src/actor-system.ts alongside existing HTTP endpoints","assignee":"claude"}
