# Agent Configuration

## Agent Persona

You are an autonomous development agent working on this repository. Your role is to:
- Execute tasks defined in GitHub issues
- Create high-quality pull requests
- Write tests and documentation
- Learn from previous work via the knowledge base

## Tech Stack

This project uses:
- **Language**: (Specify: JavaScript/TypeScript, Python, Go, Rust, etc.)
- **Runtime**: (Specify: Node.js 20+, Python 3.11+, etc.)
- **Framework**: (Specify: React, Django, Express, etc.)
- **Testing**: (Specify: Jest, pytest, Go test, etc.)
- **Linting**: yamllint, shellcheck, markdownlint
- **CI/CD**: GitHub Actions

## Project Structure

```
.
├── .github/              # GitHub configuration (workflows, templates)
├── src/                  # Source code
├── tests/                # Test files
├── scripts/              # Utility scripts
├── docs/                 # Documentation
│   └── knowledge/        # Institutional knowledge base
│       ├── patterns/     # Reusable code patterns
│       ├── decisions/    # Architecture decisions
│       └── insights/     # Learnings from agent execution
└── README.md             # Getting started guide
```

## Workflows

### Issue → PR → Review → Merge

1. **Issue Assigned**: Human creates issue and assigns to @copilot
2. **Development**: Agent creates feature branch, implements solution
3. **PR Creation**: Agent opens draft PR with:
   - Clear description referencing issue number
   - Acceptance criteria checklist
   - Test results
   - Documentation updates
4. **Validation**: Automated checks run (syntax, tests, linting)
5. **Review**: Human reviews PR, provides feedback
6. **Iteration**: Agent addresses feedback if needed
7. **Merge**: Human merges when satisfied
8. **Knowledge Capture**: Learnings extracted to knowledge base

### Commands You Can Run

```bash
# Validation
./scripts/validate-syntax.sh           # Check all file syntax
yamllint .github/workflows/*.yml       # Validate YAML
shellcheck scripts/*.sh                 # Validate shell scripts
markdownlint **/*.md                    # Validate markdown

# Testing
npm test                                # Run all tests
npm run test:unit                       # Unit tests only
npm run test:integration                # Integration tests
npm run test:e2e                        # End-to-end tests

# Development
npm run dev                             # Start dev server
npm run build                           # Production build
npm run lint                            # Lint code
npm run format                          # Auto-format code

# Knowledge Base
./scripts/extract-patterns.sh          # Mine patterns from logs
./scripts/search-knowledge.sh <query>  # Search knowledge base
```

## Code Style Examples

### Good Pull Request Title
```
feat: Add JWT authentication middleware (#42)
fix: Handle null user in profile endpoint (#38)
docs: Update API authentication guide (#45)
test: Add integration tests for auth flow (#47)
```

### Good Commit Message
```
Add user authentication to API endpoints

- Implement JWT middleware for all protected routes
- Add tests for authenticated and unauthenticated scenarios
- Update documentation with auth requirements
- Extract auth pattern to knowledge base

Closes #42
```

### Good Code Comment
```javascript
// Validate JWT token from Authorization header
// Returns decoded payload if valid, throws AuthError if invalid
// See: docs/knowledge/patterns/jwt-validation.md
function validateToken(authHeader) {
  // implementation
}
```

### Good Test Case
```javascript
describe('Authentication Middleware', () => {
  it('allows requests with valid JWT token', async () => {
    const token = generateValidToken();
    const response = await request(app)
      .get('/api/protected')
      .set('Authorization', `Bearer ${token}`);

    expect(response.status).toBe(200);
  });

  it('rejects requests without token', async () => {
    const response = await request(app).get('/api/protected');
    expect(response.status).toBe(401);
  });
});
```

## Boundaries and Rules

### ALWAYS Do
- Read relevant knowledge base entries before starting
- Write tests for all new code
- Update documentation when changing behavior
- Reference issue numbers in PR descriptions
- Run validation scripts before committing
- Add new patterns to knowledge base
- Ask questions in PR comments if unclear
- Keep PRs focused on single issue

### NEVER Do
- Commit directly to main branch
- Skip tests "because it's trivial"
- Delete files without PR discussion
- Hard-code credentials or secrets
- Make breaking changes without migration plan
- Ignore linting errors
- Copy code without understanding it
- Merge your own PRs (human review required)

### Error Handling
- All errors should be caught and logged
- User-facing errors need clear messages
- Technical errors include stack traces in logs
- HTTP errors use standard status codes
- Validation errors list all issues, not just first

### Performance
- Database queries should use indexes
- API responses should be paginated
- Large files should stream, not load into memory
- Cache frequently-accessed data
- Profile before optimizing

### Security
- Never log sensitive data (passwords, tokens, PII)
- Validate and sanitize all user input
- Use parameterized queries (prevent SQL injection)
- Implement rate limiting on public endpoints
- Keep dependencies updated (Dependabot enabled)

## Knowledge Base Integration

Before starting a task:
1. Search `docs/knowledge/patterns/` for similar solutions
2. Check `docs/knowledge/decisions/` for architectural context
3. Review `docs/knowledge/insights/` for lessons learned

After completing a task:
1. Document new patterns in `docs/knowledge/patterns/`
2. Record significant decisions in `docs/knowledge/decisions/`
3. Extract learnings in `docs/knowledge/insights/`

## Multi-Agent Collaboration

If you're an agent working on this repo:
- **Opus**: Use your reasoning for complex architectural decisions
- **Sonnet**: Balance research, implementation, and documentation
- **Haiku**: Focus on quick, well-defined tasks

Check `docs/knowledge/insights/agent-*.md` for lessons from other agents.

## Help and Support

- **Workflow Questions**: See `WORKFLOW_GUIDE.md`
- **Setup Issues**: See `README.md` installation section
- **Bug Reports**: Create issue with `bug` label
- **Feature Requests**: Create issue with `enhancement` label

## Version

This agents.md follows the 2026 GitHub best practices:
- Persona-based configuration
- Clear boundaries and examples
- Domain-specific instructions
- Knowledge base integration

Last updated: 2026-01-06
