# Interface & Capability Rules

# Capabilities: actor_id, capability_name (e.g., 'os.execute', 'web.navigate')
:create capability {
    actor_id: uuid,
    capability: string,
    =>
    granted_at: list
}

# Process Lineage: ShellNode -> SpawningActor
:create process_owner {
    shell_node: uuid,
    owner_node: uuid
}

# Security Check: Can actor A execute a command?
can_execute(actor_id) :- capability{actor_id: actor_id, capability: 'os.execute'}

# Browser State: What is the root of the DOM for a browser node?
browser_dom(browser_id, dom_root) :-
    edge{from_node: browser_id, to_node: dom_root, edge_type: 'projects_dom'}

# Cleanup Rule: Identify ShellNodes whose owners have been archived
orphaned_process(shell_id) :-
    process_owner{shell_node: shell_id, owner_node: owner},
    property{node_id: owner, key: 'status', value: 'archived'}
